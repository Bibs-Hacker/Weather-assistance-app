<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üå§Ô∏è Weather Forecast App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    /* ===== Global Styles ===== */
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Poppins', sans-serif;
      background: url('https://files.catbox.moe/b2xl1t.jpg') no-repeat center center/cover;
      color:#fff;
      overflow-x:hidden;
      position:stretch;
    }
    header {
      text-align:center;
      padding:20px;
      background:rgba(0,0,0,0.5);
      font-size:1.8rem;
      font-weight:600;
      letter-spacing:1px;
    }
    .profile-pic {
      width:120px;
      height:120px;
      border-radius:50%;
      margin:15px auto;
      border:4px solid #0ff;
      background:url('https://files.catbox.moe/b2xl1t.jpg') no-repeat center/cover;
      animation: rotate 12s linear infinite;
      position:relative;
    }
    .profile-pic::after {
      content:"";
      position:absolute;
      top:50%; left:50%;
      transform:translate(-50%,-50%);
      width:160px; height:160px;
      border-radius:50%;
      border:2px solid rgba(0,255,255,0.6);
      animation:pulse 2s infinite;
    }
    @keyframes rotate { 100% { transform:rotate(360deg); } }
    @keyframes pulse {
      0% { transform:translate(-50%,-50%) scale(0.9); opacity:0.7; }
      100% { transform:translate(-50%,-50%) scale(1.3); opacity:0; }
    }

    /* ===== Search Section ===== */
    .search-box {
      text-align:center;
      margin:20px;
    }
    .search-box input {
      padding:10px; width:60%; border:none; border-radius:25px;
      font-size:1rem; outline:none;
    }
    .search-box button {
      padding:10px 18px;
      border:none; border-radius:25px;
      background:linear-gradient(135deg,#0ff,#00f);
      color:#fff; font-size:1rem; margin-left:10px;
      cursor:pointer; transition:0.3s;
    }
    .search-box button:hover { transform:scale(1.05); }

    /* ===== Weather Display ===== */
    .weather-display {
      text-align:center;
      margin-top:10px;
      padding:15px;
      background:rgba(0,0,0,0.6);
      border-radius:12px;
      max-width:500px; margin-left:auto; margin-right:auto;
    }
    .weather-info { font-size:1.2rem; margin-top:10px; }
    .weather-info img { width:70px; }

    /* ===== Forecast ===== */
    .forecast-container {
      display:flex; flex-wrap:wrap; justify-content:center;
      margin:20px auto; max-width:900px;
    }
    .forecast-card {
      width:150px; height:200px;
      margin:10px; border-radius:15px;
      background:rgba(255,255,255,0.1);
      backdrop-filter:blur(6px);
      text-align:center; padding:10px;
      transition:transform 0.5s, box-shadow 0.5s;
      cursor:pointer;
      animation:fadeInUp 1s ease forwards;
    }
    .forecast-card:hover {
      transform:rotateY(15deg) scale(1.05);
      box-shadow:0 0 20px #0ff;
    }
    @keyframes fadeInUp {
      from { opacity:0; transform:translateY(40px); }
      to { opacity:1; transform:translateY(0); }
    }

    /* ===== AI Chatbot Overlay ===== */
    .chatbot-overlay {
      position:center-absolute; right:20px; bottom:20px;
      width:500px; height:380px;
      background:rgba(0,0,0,0.8);
      border:2px solid #0ff;
      border-radius:15px;
      display:flex; flex-direction:column;
      overflow:hidden; z-index:1000;
    }
    .chat-header {
      background:#0ff; color:#000;
      text-align:center; padding:10px;
      font-weight:600; font-size:1.2rem;
    }
    .chat-messages {
      flex:1; padding:10px; overflow-y:auto;
      font-size:1rem;
    }
    .chat-input {
      display:flex;
      border-top:1px solid #0ff;
    }
    .chat-input input {
      flex:1; padding:10px;
      border:none; outline:none;
    }
    .chat-input button {
      padding:10px; border:none;
      background:#0ff; cursor:pointer;
    }

    /* ===== Settings Panel ===== */
    .settings-panel {
      position:fixed; top:0; right:-300px;
      width:300px; height:100%;
      background:rgba(0,0,0,0.9);
      transition:0.5s; padding:20px;
      z-index:999;
    }
    .settings-panel.active { right:0; }
    .settings-btn {
      position:fixed; top:20px; left:20px;
      background:#0ff; border:none; padding:10px;
      border-radius:50%; cursor:pointer;
      z-index:1001;
    }

    /* ===== WhatsApp Feedback ===== */
    .feedback {
      text-align:center; margin:20px auto;
    }
    .feedback h3 { margin-bottom:15px; }
    .feedback a {
      display:inline-block;
      padding:12px 20px; margin:10px;
      border-radius:25px;
      background:linear-gradient(135deg,#25D366,#128C7E);
      color:#fff; font-size:1rem;
      text-decoration:none;
      transition:0.3s;
    }
    .feedback a:hover { transform:scale(1.05); }

    /* ===== Snow Effect ===== */
    .snow {
      position:fixed; top:0; left:0; width:100%; height:100%;
      pointer-events:none; overflow:hidden;
      z-index:1;
    }
    .snow span {
      position:absolute; top:-10px;
      color:#fff; font-size:20px;
      animation:fall linear infinite;
    }
    @keyframes fall {
      to { transform:translateY(110vh); opacity:0; }
    }

    footer {
      text-align:center;
      padding:15px;
      background:rgba(0,0,0,0.6);
      position:fixed;
      bottom:0; left:0; right:0;
    }
  </style>
</head>
<body>
  <header>
    KMTC Ksm Weather Forecast üå¶Ô∏è  
    <div class="profile-pic"></div>
  </header>

  <!-- Settings Button -->
  <button class="settings-btn">‚öôÔ∏è</button>
  <div class="settings-panel">
    <h2>Settings</h2>
    <p>Theme toggle, language, etc. (future expansion)</p>
  </div>

  <section class="search-box">
    <input type="text" id="cityInput" placeholder="Enter city name...">
    <button onclick="getWeather()">Search</button>
  </section>

  <div class="weather-display" id="weatherDisplay">
    <h2 id="location">City, Country</h2>
    <div class="weather-info">
      <img id="icon" src="" alt="">
      <p id="temp"></p>
      <p id="condition"></p>
      <p id="wind"></p>
      <p id="humidity"></p>
      <p id="sun"></p>
    </div>
  </div>

  <div class="forecast-container" id="forecastContainer"></div>

  <div class="feedback">
    <h3>üì© Send Us Feedback on WhatsApp</h3>
    <a href="https://wa.me/254748950572?text=Hello%20Developer,%20I%20would%20like%20to%20share%20feedback%20about%20the%20Weather%20App%20üå§Ô∏è">Chat Developer</a>
    <a href="https://wa.me/254799390998?text=Hello%20Manager,%20I%20would%20like%20to%20share%20my%20thoughts%20on%20the%20Weather%20App%20üå¶Ô∏è">Chat Manager</a>
  </div>

  <!-- Chatbot -->
  <div class="chatbot-overlay">
    <div class="chat-header">ü§ñ AI Assistant</div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input">
      <input type="text" id="chatInput" placeholder="Ask me anything...">
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

  <!-- Snow -->
  <div class="snow" id="snow"></div>

  <footer>@MERAB & BRIAN SYSTEM 2025 <br>@MEDICAL ENGINEERING CLASS: WAZIRI #Omosh </footer>

  <audio id="bgMusic" autoplay loop>
    <source src="https://files.catbox.moe/7bficz.mp3" type="audio/mpeg">
  </audio>

<script>
  const apiKey = "d974b0a304a2dc46639117d74bd8b1b8";

  async function getWeather(){
    const city=document.getElementById("cityInput").value;
    if(!city) return;
    const res=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`);
    const data=await res.json();
    if(data.cod!==200){ alert("City not found"); return; }

    document.getElementById("location").textContent=`${data.name}, ${data.sys.country}`;
    document.getElementById("temp").textContent=`üå°Ô∏è ${data.main.temp} ¬∞C`;
    document.getElementById("condition").textContent=`Condition: ${data.weather[0].description}`;
    document.getElementById("wind").textContent=`üí® Wind: ${data.wind.speed} m/s`;
    document.getElementById("humidity").textContent=`üíß Humidity: ${data.main.humidity}%`;
    document.getElementById("sun").textContent=`‚òÄÔ∏è Sun Intensity Index: ${(data.main.temp/data.main.humidity).toFixed(2)}`;

    document.getElementById("icon").src=`https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;

    // Forecast
    const res2=await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric`);
    const data2=await res2.json();
    const forecastEl=document.getElementById("forecastContainer");
    forecastEl.innerHTML="";
    for(let i=0;i<5;i++){
      const day=data2.list[i*8];
      const card=document.createElement("div");
      card.className="forecast-card";
      card.innerHTML=`
        <h4>${new Date(day.dt_txt).toDateString()}</h4>
        <img src="https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png" alt="">
        <p>${day.main.temp} ¬∞C</p>
        <p>${day.weather[0].main}</p>
      `;
      forecastEl.appendChild(card);
    }
  }

  // Settings toggle
  document.querySelector(".settings-btn").addEventListener("click",()=>{
    document.querySelector(".settings-panel").classList.toggle("active");
  });

  // Snow generator
  function createSnow(){
    const snow=document.getElementById("snow");
    const span=document.createElement("span");
    span.textContent="‚ùÑ";
    span.style.left=Math.random()*100+"%";
    span.style.animationDuration=(Math.random()*3+2)+"s";
    span.style.opacity=Math.random();
    snow.appendChild(span);
    setTimeout(()=>span.remove(),5000);
  }
  setInterval(createSnow,200);

  // Chatbot with OpenAI backend
  async function sendMessage(){
    const input=document.getElementById("chatInput");
    const msg=input.value.trim();
    if(!msg) return;
    const chat=document.getElementById("chatMessages");

    const userDiv=document.createElement("div");
    userDiv.textContent="üßë: "+msg;
    chat.appendChild(userDiv);

    input.value="";

    const resDiv=document.createElement("div");
    resDiv.textContent="ü§ñ: ...";
    chat.appendChild(resDiv);

    // Fetch AI response
    try{
      const response=await fetch("https://api.openai.com/v1/chat/completions",{
        method:"POST",
        headers:{
          "Content-Type":"application/json",
          "Authorization":"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"
        },
        body:JSON.stringify({
          model:"gpt-3.5-turbo",
          messages:[{role:"user",content:msg}]
        })
      });
      const data=await response.json();
      resDiv.textContent="ü§ñ: "+data.choices[0].message.content;
    }catch(err){
      resDiv.textContent="ü§ñ: (Error fetching AI response)";
    }

    chat.scrollTop=chat.scrollHeight;
  }
</script>
</body>
  </html>
